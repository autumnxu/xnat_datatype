$page.setTitle("Biosamples")
$page.setLinkColor($ui.alink)
$page.setVlinkColor($ui.vlink)
#set($years = [ $!turbineUtils.getYear()..1900])
<!-- #set($time = [ $!turbineUtils.getDate()]) -->

<script type="text/javascript">
window.currentID="$!om.getId()";
    #if($om.getProject()) 
     #if($om.getProject().equals(""))
window.currentProject="$!project";
     #else
window.currentProject="$!om.getProject()";
     #end
    #else
window.currentProject="$!project";
    #end

window.currentSubject="$!om.getSubjectId()";
window.currentLabel="$!om.getLabel()";
</script>
#if ($data.message)
<div class="error">$data.message</div>
#end
<div id="biosampleAssessmentFormDiv">
<form ID="biosampleAssessmentForm" name="biosampleAssessmentForm" method="post" action="$link.setAction("ModifySubjectAssessorData")">
    <input type="hidden" name="project" value="$!{project}">
    <input type="hidden" name="part_id" value="$!{subjectId}">
    <input type='hidden' name='workshop:strokeEdemaCollection/ID' value='$!item.getProperty("ID")'/>
    <input type="hidden" name="workshop:strokeEdemaCollection/project" value='$!{project}'/>
    <input type='hidden' name='workshop:strokeEdemaCollection/subject_ID' value='$!{subjectId}'/>
    <input type='hidden' name='workshop:strokeEdemaCollection/label' value='$!label'/>
    <input type="hidden" name="workshop:strokeEdemaCollection.date.month" id="workshop:strokeEdemaCollection.date.month" value=""/>
    <input type="hidden" name="workshop:strokeEdemaCollection.date.date" id="workshop:strokeEdemaCollection.date.date" value=""/>
    <input type="hidden" name="workshop:strokeEdemaCollection.date.year" id="workshop:strokeEdemaCollection.date.year" value=""/>
    <input type="hidden" name="$om.getXSIType()/ID" id="$om.getXSIType()/ID" value="$!om.getId()"/>

    #if($vr)
    <div class="error">Invalid parameters:<BR>$vr.toHTML()</div>
    <HR>
    #end

<table width="100%">
<tr>
    <td>
        <table width="100%">
            <tr>
                <td align="left" valign="middle">
                    <div class="edit_title">Biosamples</div>
                </td>
            </tr>
        </table>
    </td>
</tr>
<tr>
    <td>
        <table width="100%">
            <tr>
                <td valign="top" colspan=2>
                    <table>
                        <tr>
                            <td colspan="2">#parse("/screens/EditProjectSpecificFields.vm")</td>
                        </tr>
                        <tr>
                             <td colspan="2">Have the following stroke information be taken and stored as per protocol?</td>
                        </tr>
                        <tr>
                             #formLabel("Scan_Date")
                             <td>
                                #xdatDateBox("workshop:strokeEdemaCollection/scan_date" $item $vr $years)
                             </td>
                        </tr>     
                         <tr>
                             #formLabel("Scan_Timing")
                             <td>
                                <!-- #xdatTimeBox("workshop:strokeEdemaCollection/scan_time" $item $vr $time) -->
                                #xdatStringBox("workshop:strokeEdemaCollection/scan_timing" $item $vr)
                             </td>
                         </tr>    
                         <tr>
                             #formLabel("Scan_Identification")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/scan_identification" $item $vr $years)
                             </td>
                        </tr>                           
                         <tr>
                             #formLabel("Slice_Thickness")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/slice_thickness" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("DICOM_pixel_size_x")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/dicom_pixel_size_x" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("DICOM_pixel_size_y")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/dicom_pixel_size_y" $item $vr)
                             </td>
                         </tr>
                         <!--
                         <tr>
                             #formLabel("Z_Axial_Brain_Scan")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/z_axial_brain_scan" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("Z_Brain_Thin_Scans")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/z_brain_thin_scans" $item $vr)
                             </td>
                         </tr>
                         -->
                         <tr>
                             #formLabel("Total_Cerebrospinal_Fluid_Volume")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/total_cerebrospinal_fluid_volume" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("Cerebrospinal_Fluid_Ratio")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/cerebrospinal_fluid_ratio" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("Selected_Scan_Number")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/selected_scan_number" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("Slice_Number")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/slice_number" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("X_Dimension")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/x_dimension" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("Y_Dimension")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/y_dimension" $item $vr)
                             </td>
                         </tr>
                         <tr>
                             #formLabel("Net_Water_Uptake")
                             <td>
                                #xdatStringBox("workshop:strokeEdemaCollection/net_water_uptake" $item $vr)
                             </td>
                         </tr>
                         <!--
                         <tr>
                             #formLabel("Tilt")
                             <td>
                                 #xdatBooleanRadioYesNoWithoutDefault("workshop:strokeEdemaCollection/Tilt" $item $vr)
                             </td>
                         </tr>
                         -->
                     </table>
                 </td>
            </tr>
        </table>
    </td>
</tr>
<tr>
    <td>
        #xdatEditProps($item $edit_screen)
    </td>
</tr>
<tr>
    <td colspan=2 align=left>
        <input type="button" onclick="validateForm();" name="eventSubmit_doInsert" value="Submit"/>
    </td>
</tr>
</table>
</form>
</div>

<script type="text/javascript">
    function validateForm() {
        var today = new Date();
        document.getElementById('workshop:strokeEdemaCollection.date.month').value = today.getMonth();
        document.getElementById('workshop:strokeEdemaCollection.date.date').value = today.getDate();
        document.getElementById('workshop:strokeEdemaCollection.date.year').value = today.getFullYear();

        document.biosampleAssessmentForm.submit();
        return true;
    }
</script>
